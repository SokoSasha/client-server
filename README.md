Реализация TCP/UDP серверов и клиентов.

TCP-клиент1 отправляет на сервер сообщенние "put", после чего отправляет данные из файла в формате: hh:mm:ss hh:mm:ss BBB message, где hh - время от 00 до 23 часов, mm и ss - время от 00 до 59 минут/секунд, BBB - целое число от 0 до 4 294 967 295, message - строка любой длины (считывается до переноса строки).
hh, mm и ss отправляются в размере 1 байта каждый, BBB - в размере 4 байта в сетевом порядке байтов.
После каждого отправленного сообщения клиент ожидает подтверждение от сервера, что сообщение было принято (ожидание сообщения "ok").

TCP-клиент2 отправляет на сервер сообщенние "get", после чего сервер отправляет все полученные ранее и записанные в соотвествующий файл сообщения. Клиент принимает эти сообщения и помещает их в отдельный файл. В начале каждого сообщения пишется информация IP:PORT откуда было принято сообщение.

TCP-сервер работает в неблокирующем режиме и может осуществлять пересылку данных сразу с несколькими клиентами. При получении сообщения "put" он принимает сообщения от клиента и отвечает на каждое сообщение подтверждением о приеме. Каждое сообщение помещается в файл "msg.txt" в формате "IP:PORT hh:mm:ss hh:mm:ss BBB message", где IP И PORT - данные о клиенте.
При получении сообщения "get" отправляет все сообщения из файла "msg.txt" клиенту. Работа остальных клиентов при этом приостанавливается, иначе текстовый файл может повредиться.


UDP-клиент считывает сообщения из текстового файла в том же формате, как и TCP-клиент, и на их основе формирует датаграммы, которые отправляет серверу. Сообщения отправляются до тех пор, пока сервер не получит 20 любых сообщений (если сообщений в файле меньше, то все сообщения). Клиент принимает от сервера номера уже принятых сообщений и исключает их из очереди на отправку.

UDP-сервер может параллельно обслуживать несколько клиентов и портов. Он принимает датаграммы от клиентов, расшифровывает их и записывает в "msg.txt" файл. В датаграммах также содержаться номера сообщений согласно тому, как они расположенны в файле клиента. Сервер создает небольшую "базу данных", куда записывает информацию о каждом клиенте: IP-адресс и порт, количество уже принятых сообщений, номера принятый сообщений. Когда сервер принимает сообщение, он отправляет номер этого сообщения обратно клиенту. При отсутствии какой-либо информации от клиента в течении 30 секунд информация о нем удаляется из БД.
